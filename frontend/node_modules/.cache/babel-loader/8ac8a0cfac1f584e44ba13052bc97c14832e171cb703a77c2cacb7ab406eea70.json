{"ast":null,"code":"var _jsxFileName = \"D:\\\\intelligent translator\\\\frontend\\\\src\\\\pages\\\\WorkspacePage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport { getConversationById, addMessageToConversation, updateConversationSettings, callTextToSpeechApi, editMessage, deleteMessage, exportConversation, transcribeAudio, getPrompts } from '../apiClient';\nimport { FaPaperPlane, FaVolumeUp, FaSpinner, FaExchangeAlt, FaCog, FaTimes, FaEdit, FaTrash, FaCopy, FaDownload, FaShareAlt, FaFileExport, FaMicrophone, FaStop, FaPaperclip } from 'react-icons/fa';\nimport './WorkspacePage.scss';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst sourceLanguages = [{\n  code: 'auto',\n  name: 'اكتشاف تلقائي'\n}, {\n  code: 'ar',\n  name: 'العربية'\n}, {\n  code: 'en',\n  name: 'English'\n}, {\n  code: 'fr',\n  name: 'Français'\n}, {\n  code: 'de',\n  name: 'Deutsch'\n}, {\n  code: 'es',\n  name: 'Español'\n}];\nconst targetLanguages = [{\n  code: 'en',\n  name: 'English'\n}, {\n  code: 'ar',\n  name: 'العربية'\n}, {\n  code: 'fr',\n  name: 'Français'\n}, {\n  code: 'de',\n  name: 'Deutsch'\n}, {\n  code: 'es',\n  name: 'Español'\n}];\nconst highlightText = (text, query) => {\n  if (!query) {\n    return text;\n  }\n  const parts = text.split(new RegExp(`(${query})`, 'gi'));\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    children: parts.map((part, index) => part.toLowerCase() === query.toLowerCase() ? /*#__PURE__*/_jsxDEV(\"mark\", {\n      children: part\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 11\n    }, this) : part)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n};\nfunction WorkspacePage() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const [conversation, setConversation] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [inputText, setInputText] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [isTranscribing, setIsTranscribing] = useState(false);\n  const [error, setError] = useState('');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [sourceLang, setSourceLang] = useState('auto');\n  const [targetLang, setTargetLang] = useState('en');\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n  const [currentUseContext, setCurrentUseContext] = useState(true);\n  const [currentCustomPrompt, setCurrentCustomPrompt] = useState('');\n  const [saveSettingsStatus, setSaveSettingsStatus] = useState('');\n  const [editingMessage, setEditingMessage] = useState({\n    id: null,\n    text: ''\n  });\n  const [messageSearchQuery, setMessageSearchQuery] = useState('');\n\n  // **التعديل**: تحسين حالة النسخ لتحديد نوع النص المنسوخ (أصلي أو مترجم)\n  const [copyStatus, setCopyStatus] = useState({\n    id: null,\n    type: null\n  });\n  const [isRecording, setIsRecording] = useState(false);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const micButtonRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const [promptLibrary, setPromptLibrary] = useState([]);\n  const messagesEndRef = useRef(null);\n  const audioRef = useRef(null);\n  useEffect(() => {\n    const fetchConversation = async () => {\n      try {\n        const response = await getConversationById(id);\n        setConversation(response.data);\n        setMessages(response.data.messages);\n        setCurrentUseContext(response.data.use_context);\n        setCurrentCustomPrompt(response.data.custom_prompt || '');\n      } catch (err) {\n        setError('فشل في تحميل المحادثة.');\n        console.error(err);\n      }\n    };\n    if (id) {\n      fetchConversation();\n    }\n  }, [id]);\n  useEffect(() => {\n    if (!messageSearchQuery) {\n      var _messagesEndRef$curre;\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    }\n  }, [messages, messageSearchQuery]);\n  useEffect(() => {\n    const button = micButtonRef.current;\n    if (button) {\n      const handleTouchStart = e => {\n        handleStartRecording(e);\n      };\n      button.addEventListener('touchstart', handleTouchStart, {\n        passive: false\n      });\n      return () => {\n        button.removeEventListener('touchstart', handleTouchStart);\n      };\n    }\n  }, [isRecording]);\n  useEffect(() => {\n    if (isSettingsOpen) {\n      const fetchPromptLibrary = async () => {\n        try {\n          const response = await getPrompts();\n          setPromptLibrary(response.data);\n        } catch (err) {\n          console.error(\"Failed to fetch prompt library\", err);\n        }\n      };\n      fetchPromptLibrary();\n    }\n  }, [isSettingsOpen]);\n  const handleSwapLanguages = () => {\n    if (sourceLang === 'auto') return;\n    const newSourceLang = targetLang;\n    const newTargetLang = sourceLang;\n    setSourceLang(newSourceLang);\n    setTargetLang(newTargetLang);\n  };\n  const handleTranslate = async e => {\n    if (e) e.preventDefault();\n    if (!inputText.trim() || isLoading) return;\n    const tempId = Date.now();\n    const optimisticMessage = {\n      id: tempId,\n      original_text: inputText,\n      translated_text: \"جاري الترجمة...\",\n      created_at: new Date().toISOString(),\n      status: 'pending'\n    };\n    setMessages(prevMessages => [...prevMessages, optimisticMessage]);\n    setInputText('');\n    setIsLoading(true);\n    setError('');\n    try {\n      var _targetLanguages$find;\n      const targetLanguageName = ((_targetLanguages$find = targetLanguages.find(lang => lang.code === targetLang)) === null || _targetLanguages$find === void 0 ? void 0 : _targetLanguages$find.name) || 'English';\n      const response = await addMessageToConversation(id, optimisticMessage.original_text, targetLanguageName);\n      setMessages(prevMessages => prevMessages.map(msg => msg.id === tempId ? response.data : msg));\n    } catch (apiError) {\n      var _apiError$response, _apiError$response$da;\n      console.error(\"API call failed:\", apiError);\n      const errorDetail = ((_apiError$response = apiError.response) === null || _apiError$response === void 0 ? void 0 : (_apiError$response$da = _apiError$response.data) === null || _apiError$response$da === void 0 ? void 0 : _apiError$response$da.detail) || \"فشل في إرسال الرسالة.\";\n      setError(errorDetail);\n      setMessages(prevMessages => prevMessages.map(msg => msg.id === tempId ? {\n        ...msg,\n        status: 'error',\n        translated_text: 'فشلت الترجمة'\n      } : msg));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleDeleteMessage = async messageId => {\n    if (window.confirm('هل أنت متأكد من حذف هذه الرسالة؟')) {\n      try {\n        await deleteMessage(messageId);\n        setMessages(prev => prev.filter(msg => msg.id !== messageId));\n      } catch (err) {\n        setError('فشل في حذف الرسالة.');\n        console.error(err);\n      }\n    }\n  };\n  const handleStartEditing = message => {\n    setEditingMessage({\n      id: message.id,\n      text: message.original_text\n    });\n  };\n  const handleCancelEditing = () => {\n    setEditingMessage({\n      id: null,\n      text: ''\n    });\n  };\n  const handleSaveEdit = async () => {\n    if (!editingMessage.text.trim()) return;\n    setIsLoading(true);\n    try {\n      const response = await editMessage(editingMessage.id, editingMessage.text);\n      setMessages(prev => prev.map(msg => msg.id === editingMessage.id ? response.data : msg));\n      handleCancelEditing();\n    } catch (err) {\n      setError('فشل في تعديل الرسالة.');\n      console.error(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handlePlayAudio = async (text, messageId) => {\n    if (playingAudioId === messageId) {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current.currentTime = 0;\n      }\n      setPlayingAudioId(null);\n      return;\n    }\n    setPlayingAudioId(messageId);\n    try {\n      const response = await callTextToSpeechApi(text);\n      const audioBlob = response.data;\n      const audioUrl = URL.createObjectURL(audioBlob);\n      const audio = new Audio(audioUrl);\n      audioRef.current = audio;\n      audio.play();\n      audio.onended = () => {\n        setPlayingAudioId(null);\n      };\n      audio.onerror = e => {\n        console.error(\"Audio playback error:\", e);\n        setError('حدث خطأ أثناء تشغيل الصوت.');\n        setPlayingAudioId(null);\n      };\n    } catch (err) {\n      setError('فشل في توليد الصوت.');\n      setPlayingAudioId(null);\n    }\n  };\n  const handleSaveSettings = async () => {\n    setSaveSettingsStatus('جاري الحفظ...');\n    try {\n      const settingsToUpdate = {\n        use_context: currentUseContext,\n        custom_prompt: currentCustomPrompt\n      };\n      const response = await updateConversationSettings(id, settingsToUpdate);\n      setConversation(response.data);\n      setSaveSettingsStatus('تم الحفظ بنجاح!');\n      setTimeout(() => {\n        setIsSettingsOpen(false);\n        setSaveSettingsStatus('');\n      }, 1500);\n    } catch (err) {\n      setSaveSettingsStatus('فشل الحفظ. حاول مرة أخرى.');\n      console.error(\"Failed to save settings:\", err);\n    }\n  };\n\n  // **التعديل**: تحديث دالة النسخ لتقبل نوع النص\n  const handleCopyText = (text, messageId, type) => {\n    navigator.clipboard.writeText(text).then(() => {\n      setCopyStatus({\n        id: messageId,\n        type: type\n      });\n      setTimeout(() => setCopyStatus({\n        id: null,\n        type: null\n      }), 2000);\n    }, err => {\n      console.error('Could not copy text: ', err);\n      setError('فشل نسخ النص.');\n    });\n  };\n  const handleShareText = async text => {\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: 'ترجمة من المترجم الذكي',\n          text: text\n        });\n      } catch (err) {\n        console.error('Error sharing:', err);\n      }\n    } else {\n      setError('المشاركة غير مدعومة في هذا المتصفح.');\n    }\n  };\n  const handleDownloadAudio = async text => {\n    setIsLoading(true);\n    setError('');\n    try {\n      const response = await callTextToSpeechApi(text);\n      const audioBlob = response.data;\n      const url = window.URL.createObjectURL(audioBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', `translation-${Date.now()}.mp3`);\n      document.body.appendChild(link);\n      link.click();\n      link.parentNode.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (err) {\n      setError('فشل في تنزيل الملف الصوتي.');\n      console.error(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleExport = async () => {\n    try {\n      const response = await exportConversation(id);\n      const textBlob = new Blob([response.data], {\n        type: 'text/plain;charset=utf-8'\n      });\n      const url = window.URL.createObjectURL(textBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', `${conversation.title.replace(/\\s/g, '_')}.txt`);\n      document.body.appendChild(link);\n      link.click();\n      link.parentNode.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (err) {\n      setError('فشل في تصدير المحادثة.');\n      console.error(\"Failed to export conversation:\", err);\n    }\n  };\n  const transcribeFile = async file => {\n    if (!file) return;\n    setIsTranscribing(true);\n    setError('');\n    try {\n      const response = await transcribeAudio(file);\n      setInputText(prev => prev.trim() ? prev + ' ' + response.data.transcribed_text : response.data.transcribed_text);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      const errorDetail = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || 'فشل في تحويل الصوت إلى نص.';\n      setError(errorDetail);\n      console.error(\"Transcription failed:\", err);\n    } finally {\n      setIsTranscribing(false);\n    }\n  };\n  const handleStartRecording = async e => {\n    e.preventDefault();\n    setError('');\n    if (isRecording || isTranscribing) return;\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          audio: true\n        });\n        setIsRecording(true);\n        mediaRecorderRef.current = new MediaRecorder(stream);\n        mediaRecorderRef.current.ondataavailable = event => {\n          audioChunksRef.current.push(event.data);\n        };\n        mediaRecorderRef.current.onstop = async () => {\n          const audioBlob = new Blob(audioChunksRef.current, {\n            type: 'audio/webm'\n          });\n          audioChunksRef.current = [];\n          stream.getTracks().forEach(track => track.stop());\n          if (audioBlob.size > 0) {\n            await transcribeFile(audioBlob);\n          }\n        };\n        mediaRecorderRef.current.start();\n      } catch (err) {\n        console.error(\"Error accessing microphone:\", err);\n        setError(\"لا يمكن الوصول إلى الميكروفون. يرجى التحقق من الأذونات.\");\n        setIsRecording(false);\n      }\n    } else {\n      setError(\"المتصفح لا يدعم التسجيل الصوتي.\");\n    }\n  };\n  const handleStopRecording = e => {\n    e.preventDefault();\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n    }\n  };\n  const handleFileSelect = event => {\n    const file = event.target.files[0];\n    if (file) {\n      transcribeFile(file);\n    }\n    event.target.value = null;\n  };\n  const handleUploadClick = () => {\n    if (isTranscribing) return;\n    fileInputRef.current.click();\n  };\n  const renderInputActions = () => {\n    if (isTranscribing) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"mic-button\",\n        disabled: true,\n        children: /*#__PURE__*/_jsxDEV(FaSpinner, {\n          className: \"fa-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 17\n      }, this);\n    }\n    if (inputText.trim()) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"translate-button\",\n        disabled: isLoading,\n        children: isLoading ? /*#__PURE__*/_jsxDEV(FaSpinner, {\n          className: \"fa-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 34\n        }, this) : /*#__PURE__*/_jsxDEV(FaPaperPlane, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 69\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 17\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"mic-button\",\n        onClick: handleUploadClick,\n        title: \"\\u062A\\u062D\\u0645\\u064A\\u0644 \\u0645\\u0644\\u0641 \\u0635\\u0648\\u062A\\u064A\",\n        children: /*#__PURE__*/_jsxDEV(FaPaperclip, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        ref: micButtonRef,\n        type: \"button\",\n        className: `mic-button ${isRecording ? 'recording' : ''}`,\n        onMouseDown: handleStartRecording,\n        onMouseUp: handleStopRecording,\n        onTouchEnd: handleStopRecording,\n        title: \"\\u0627\\u0636\\u063A\\u0637 \\u0628\\u0627\\u0633\\u062A\\u0645\\u0631\\u0627\\u0631 \\u0644\\u0644\\u062A\\u0633\\u062C\\u064A\\u0644\",\n        children: isRecording ? /*#__PURE__*/_jsxDEV(FaStop, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 36\n        }, this) : /*#__PURE__*/_jsxDEV(FaMicrophone, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 49\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  };\n  if (!conversation) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-container\",\n      children: \"\\u062C\\u0627\\u0631\\u064A \\u062A\\u062D\\u0645\\u064A\\u0644 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 16\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-container workspace-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"workspace-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-top-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: conversation.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"icon-button\",\n              onClick: handleExport,\n              title: \"\\u062A\\u0635\\u062F\\u064A\\u0631 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\",\n              children: /*#__PURE__*/_jsxDEV(FaFileExport, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 30\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"icon-button\",\n              onClick: () => setIsSettingsOpen(true),\n              title: \"\\u0625\\u0639\\u062F\\u0627\\u062F\\u0627\\u062A \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\",\n              children: /*#__PURE__*/_jsxDEV(FaCog, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-bottom-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"\\u0627\\u0628\\u062D\\u062B \\u0641\\u064A \\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644...\",\n            className: \"message-search-bar\",\n            value: messageSearchQuery,\n            onChange: e => setMessageSearchQuery(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 460,\n            columnNumber: 26\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"language-controls\",\n            children: [/*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"language-select\",\n              value: sourceLang,\n              onChange: e => setSourceLang(e.target.value),\n              children: sourceLanguages.map(lang => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: lang.code,\n                children: lang.name\n              }, lang.code, false, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 37\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"swap-languages-button\",\n              onClick: handleSwapLanguages,\n              title: \"\\u062A\\u0628\\u062F\\u064A\\u0644 \\u0627\\u0644\\u0644\\u063A\\u0627\\u062A\",\n              disabled: sourceLang === 'auto',\n              children: /*#__PURE__*/_jsxDEV(FaExchangeAlt, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 474,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"language-select\",\n              value: targetLang,\n              onChange: e => setTargetLang(e.target.value),\n              children: targetLanguages.map(lang => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: lang.code,\n                children: lang.name\n              }, lang.code, false, {\n                fileName: _jsxFileName,\n                lineNumber: 478,\n                columnNumber: 37\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 476,\n              columnNumber: 30\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message-history\",\n        children: [messages.map(msg => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message-pair ${msg.status || ''}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message original-message\",\n            children: editingMessage.id === msg.id ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"edit-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                className: \"edit-textarea\",\n                value: editingMessage.text,\n                onChange: e => setEditingMessage({\n                  ...editingMessage,\n                  text: e.target.value\n                }),\n                autoFocus: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 491,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"edit-buttons\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"button-primary\",\n                  onClick: handleSaveEdit,\n                  disabled: isLoading,\n                  children: isLoading ? 'جاري...' : 'حفظ'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 493,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleCancelEditing,\n                  children: \"\\u0625\\u0644\\u063A\\u0627\\u0621\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 37\n            }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"message-content\",\n                children: highlightText(msg.original_text, messageSearchQuery)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 499,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"message-actions\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleCopyText(msg.original_text, msg.id, 'original'),\n                  title: \"\\u0646\\u0633\\u062E\",\n                  children: copyStatus.id === msg.id && copyStatus.type === 'original' ? 'تم!' : /*#__PURE__*/_jsxDEV(FaCopy, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 503,\n                    columnNumber: 119\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 502,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleStartEditing(msg),\n                  title: \"\\u062A\\u0639\\u062F\\u064A\\u0644\",\n                  children: /*#__PURE__*/_jsxDEV(FaEdit, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 505,\n                    columnNumber: 107\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 505,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleDeleteMessage(msg.id),\n                  title: \"\\u062D\\u0630\\u0641\",\n                  children: /*#__PURE__*/_jsxDEV(FaTrash, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 506,\n                    columnNumber: 109\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 506,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 500,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message translated-message\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"message-content\",\n              children: [msg.status === 'pending' && /*#__PURE__*/_jsxDEV(FaSpinner, {\n                className: \"fa-spin message-spinner\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 513,\n                columnNumber: 66\n              }, this), highlightText(msg.translated_text, messageSearchQuery)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 33\n            }, this), msg.status !== 'pending' && msg.status !== 'error' && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleCopyText(msg.translated_text, msg.id, 'translated'),\n                title: \"\\u0646\\u0633\\u062E \\u0627\\u0644\\u0646\\u0635\",\n                children: copyStatus.id === msg.id && copyStatus.type === 'translated' ? 'تم النسخ!' : /*#__PURE__*/_jsxDEV(FaCopy, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 519,\n                  columnNumber: 119\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 518,\n                columnNumber: 39\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"play-audio-button\",\n                onClick: () => handlePlayAudio(msg.translated_text, msg.id),\n                title: \"\\u0627\\u0644\\u0627\\u0633\\u062A\\u0645\\u0627\\u0639 \\u0644\\u0644\\u062A\\u0631\\u062C\\u0645\\u0629\",\n                children: playingAudioId === msg.id ? /*#__PURE__*/_jsxDEV(FaSpinner, {\n                  className: \"fa-spin\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 522,\n                  columnNumber: 70\n                }, this) : /*#__PURE__*/_jsxDEV(FaVolumeUp, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 522,\n                  columnNumber: 106\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleDownloadAudio(msg.translated_text),\n                title: \"\\u062A\\u0646\\u0632\\u064A\\u0644 \\u0627\\u0644\\u0635\\u0648\\u062A\",\n                children: /*#__PURE__*/_jsxDEV(FaDownload, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 525,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 524,\n                columnNumber: 37\n              }, this), navigator.share && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleShareText(msg.translated_text),\n                title: \"\\u0645\\u0634\\u0627\\u0631\\u0643\\u0629 \\u0627\\u0644\\u0646\\u0635\",\n                children: /*#__PURE__*/_jsxDEV(FaShareAlt, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 529,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 528,\n                columnNumber: 39\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 517,\n              columnNumber: 35\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 29\n          }, this)]\n        }, msg.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 25\n        }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 17\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-message error\",\n        onClick: () => setError(''),\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 540,\n        columnNumber: 27\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"translation-input-area\",\n        onSubmit: handleTranslate,\n        children: [/*#__PURE__*/_jsxDEV(TextareaAutosize, {\n          className: \"text-area\",\n          value: inputText,\n          onChange: e => setInputText(e.target.value),\n          placeholder: isTranscribing ? \"جاري تفريغ الصوت...\" : \"اكتب النص...\",\n          onKeyDown: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              handleTranslate(null);\n            }\n          },\n          minRows: 1,\n          maxRows: 6,\n          cacheMeasurements: true,\n          disabled: isTranscribing\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 543,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          ref: fileInputRef,\n          onChange: handleFileSelect,\n          style: {\n            display: 'none'\n          },\n          accept: \"audio/*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 21\n        }, this), renderInputActions()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 542,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 13\n    }, this), isSettingsOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u0625\\u0639\\u062F\\u0627\\u062F\\u0627\\u062A \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"modal-close-button\",\n            onClick: () => setIsSettingsOpen(false),\n            children: /*#__PURE__*/_jsxDEV(FaTimes, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 572,\n              columnNumber: 109\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u062A\\u0641\\u0639\\u064A\\u0644 \\u0633\\u064A\\u0627\\u0642 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 575,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"toggle-switch\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              id: \"context-toggle\",\n              checked: currentUseContext,\n              onChange: e => setCurrentUseContext(e.target.checked)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 577,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"context-toggle\",\n              className: \"switch-label\",\n              children: \"Toggle\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 578,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: currentUseContext ? \"مفعل\" : \"معطل\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 579,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 576,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"description\",\n            children: \"\\u0639\\u0646\\u062F \\u0627\\u0644\\u062A\\u0641\\u0639\\u064A\\u0644\\u060C \\u0633\\u064A\\u062A\\u0645 \\u0625\\u0631\\u0633\\u0627\\u0644 \\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644 \\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\\u0629 \\u0645\\u0639 \\u0643\\u0644 \\u0637\\u0644\\u0628 \\u062C\\u062F\\u064A\\u062F \\u0644\\u062A\\u062D\\u0633\\u064A\\u0646 \\u062F\\u0642\\u0629 \\u0627\\u0644\\u062A\\u0631\\u062C\\u0645\\u0629.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"custom-prompt-select\",\n            children: \"\\u0628\\u0631\\u0648\\u0645\\u0628\\u062A \\u0645\\u062E\\u0635\\u0635\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            id: \"custom-prompt-select\",\n            className: \"form-input\",\n            value: currentCustomPrompt,\n            onChange: e => setCurrentCustomPrompt(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u0628\\u062F\\u0648\\u0646 \\u0628\\u0631\\u0648\\u0645\\u0628\\u062A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 592,\n              columnNumber: 33\n            }, this), promptLibrary.map(prompt => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: prompt.content,\n              children: prompt.title\n            }, prompt.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 594,\n              columnNumber: 37\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 586,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"description\",\n            children: \"\\u0627\\u062E\\u062A\\u0631 \\u0628\\u0631\\u0648\\u0645\\u0628\\u062A \\u062C\\u0627\\u0647\\u0632 \\u0645\\u0646 \\u0645\\u0643\\u062A\\u0628\\u062A\\u0643 \\u0644\\u062A\\u0637\\u0628\\u064A\\u0642\\u0647 \\u0639\\u0644\\u0649 \\u0647\\u0630\\u0647 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button-primary\",\n          onClick: handleSaveSettings,\n          children: \"\\u062D\\u0641\\u0638 \\u0627\\u0644\\u0625\\u0639\\u062F\\u0627\\u062F\\u0627\\u062A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 25\n        }, this), saveSettingsStatus && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"status-message\",\n          style: {\n            color: 'green'\n          },\n          children: saveSettingsStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 603,\n          columnNumber: 48\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 569,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 568,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true);\n}\n_s(WorkspacePage, \"OmgePCMNq8nv6b+oxaJHkuf+PY4=\", false, function () {\n  return [useParams];\n});\n_c = WorkspacePage;\nexport default WorkspacePage;\nvar _c;\n$RefreshReg$(_c, \"WorkspacePage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","TextareaAutosize","getConversationById","addMessageToConversation","updateConversationSettings","callTextToSpeechApi","editMessage","deleteMessage","exportConversation","transcribeAudio","getPrompts","FaPaperPlane","FaVolumeUp","FaSpinner","FaExchangeAlt","FaCog","FaTimes","FaEdit","FaTrash","FaCopy","FaDownload","FaShareAlt","FaFileExport","FaMicrophone","FaStop","FaPaperclip","jsxDEV","_jsxDEV","Fragment","_Fragment","sourceLanguages","code","name","targetLanguages","highlightText","text","query","parts","split","RegExp","children","map","part","index","toLowerCase","fileName","_jsxFileName","lineNumber","columnNumber","WorkspacePage","_s","id","conversation","setConversation","messages","setMessages","inputText","setInputText","isLoading","setIsLoading","isTranscribing","setIsTranscribing","error","setError","playingAudioId","setPlayingAudioId","sourceLang","setSourceLang","targetLang","setTargetLang","isSettingsOpen","setIsSettingsOpen","currentUseContext","setCurrentUseContext","currentCustomPrompt","setCurrentCustomPrompt","saveSettingsStatus","setSaveSettingsStatus","editingMessage","setEditingMessage","messageSearchQuery","setMessageSearchQuery","copyStatus","setCopyStatus","type","isRecording","setIsRecording","mediaRecorderRef","audioChunksRef","micButtonRef","fileInputRef","promptLibrary","setPromptLibrary","messagesEndRef","audioRef","fetchConversation","response","data","use_context","custom_prompt","err","console","_messagesEndRef$curre","current","scrollIntoView","behavior","button","handleTouchStart","e","handleStartRecording","addEventListener","passive","removeEventListener","fetchPromptLibrary","handleSwapLanguages","newSourceLang","newTargetLang","handleTranslate","preventDefault","trim","tempId","Date","now","optimisticMessage","original_text","translated_text","created_at","toISOString","status","prevMessages","_targetLanguages$find","targetLanguageName","find","lang","msg","apiError","_apiError$response","_apiError$response$da","errorDetail","detail","handleDeleteMessage","messageId","window","confirm","prev","filter","handleStartEditing","message","handleCancelEditing","handleSaveEdit","handlePlayAudio","pause","currentTime","audioBlob","audioUrl","URL","createObjectURL","audio","Audio","play","onended","onerror","handleSaveSettings","settingsToUpdate","setTimeout","handleCopyText","navigator","clipboard","writeText","then","handleShareText","share","title","handleDownloadAudio","url","link","document","createElement","href","setAttribute","body","appendChild","click","parentNode","removeChild","revokeObjectURL","handleExport","textBlob","Blob","replace","transcribeFile","file","transcribed_text","_err$response","_err$response$data","mediaDevices","getUserMedia","stream","MediaRecorder","ondataavailable","event","push","onstop","getTracks","forEach","track","stop","size","start","handleStopRecording","handleFileSelect","target","files","value","handleUploadClick","renderInputActions","className","disabled","onClick","ref","onMouseDown","onMouseUp","onTouchEnd","placeholder","onChange","autoFocus","onSubmit","onKeyDown","key","shiftKey","minRows","maxRows","cacheMeasurements","style","display","accept","checked","htmlFor","prompt","content","color","_c","$RefreshReg$"],"sources":["D:/intelligent translator/frontend/src/pages/WorkspacePage.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport TextareaAutosize from 'react-textarea-autosize';\r\nimport { \r\n  getConversationById, \r\n  addMessageToConversation, \r\n  updateConversationSettings, \r\n  callTextToSpeechApi,\r\n  editMessage,\r\n  deleteMessage,\r\n  exportConversation,\r\n  transcribeAudio,\r\n  getPrompts\r\n} from '../apiClient';\r\nimport { \r\n  FaPaperPlane, FaVolumeUp, FaSpinner, FaExchangeAlt, \r\n  FaCog, FaTimes, FaEdit, FaTrash,\r\n  FaCopy, FaDownload, FaShareAlt,\r\n  FaFileExport, FaMicrophone, FaStop, FaPaperclip\r\n} from 'react-icons/fa';\r\nimport './WorkspacePage.scss';\r\n\r\nconst sourceLanguages = [\r\n    { code: 'auto', name: 'اكتشاف تلقائي' },\r\n    { code: 'ar', name: 'العربية' },\r\n    { code: 'en', name: 'English' },\r\n    { code: 'fr', name: 'Français' },\r\n    { code: 'de', name: 'Deutsch' },\r\n    { code: 'es', name: 'Español' },\r\n];\r\nconst targetLanguages = [\r\n    { code: 'en', name: 'English' },\r\n    { code: 'ar', name: 'العربية' },\r\n    { code: 'fr', name: 'Français' },\r\n    { code: 'de', name: 'Deutsch' },\r\n    { code: 'es', name: 'Español' },\r\n];\r\nconst highlightText = (text, query) => {\r\n  if (!query) {\r\n    return text;\r\n  }\r\n  const parts = text.split(new RegExp(`(${query})`, 'gi'));\r\n  return (\r\n    <span>\r\n      {parts.map((part, index) =>\r\n        part.toLowerCase() === query.toLowerCase() ? (\r\n          <mark key={index}>{part}</mark>\r\n        ) : (\r\n          part\r\n        )\r\n      )}\r\n    </span>\r\n  );\r\n};\r\n\r\n\r\nfunction WorkspacePage() {\r\n    const { id } = useParams();\r\n    const [conversation, setConversation] = useState(null);\r\n    const [messages, setMessages] = useState([]);\r\n    const [inputText, setInputText] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [isTranscribing, setIsTranscribing] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [playingAudioId, setPlayingAudioId] = useState(null);\r\n    const [sourceLang, setSourceLang] = useState('auto');\r\n    const [targetLang, setTargetLang] = useState('en');\r\n\r\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\r\n    const [currentUseContext, setCurrentUseContext] = useState(true);\r\n    const [currentCustomPrompt, setCurrentCustomPrompt] = useState('');\r\n    const [saveSettingsStatus, setSaveSettingsStatus] = useState('');\r\n    const [editingMessage, setEditingMessage] = useState({ id: null, text: '' });\r\n    const [messageSearchQuery, setMessageSearchQuery] = useState('');\r\n    \r\n    // **التعديل**: تحسين حالة النسخ لتحديد نوع النص المنسوخ (أصلي أو مترجم)\r\n    const [copyStatus, setCopyStatus] = useState({ id: null, type: null });\r\n    \r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const mediaRecorderRef = useRef(null);\r\n    const audioChunksRef = useRef([]);\r\n    const micButtonRef = useRef(null);\r\n    const fileInputRef = useRef(null);\r\n\r\n    const [promptLibrary, setPromptLibrary] = useState([]);\r\n    const messagesEndRef = useRef(null);\r\n    const audioRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const fetchConversation = async () => {\r\n            try {\r\n                const response = await getConversationById(id);\r\n                setConversation(response.data);\r\n                setMessages(response.data.messages);\r\n                setCurrentUseContext(response.data.use_context);\r\n                setCurrentCustomPrompt(response.data.custom_prompt || '');\r\n            } catch (err) {\r\n                setError('فشل في تحميل المحادثة.');\r\n                console.error(err);\r\n            }\r\n        };\r\n        if (id) {\r\n            fetchConversation();\r\n        }\r\n    }, [id]);\r\n\r\n    useEffect(() => {\r\n        if (!messageSearchQuery) {\r\n            messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n        }\r\n    }, [messages, messageSearchQuery]);\r\n\r\n    useEffect(() => {\r\n        const button = micButtonRef.current;\r\n        if (button) {\r\n            const handleTouchStart = (e) => {\r\n                handleStartRecording(e);\r\n            };\r\n\r\n            button.addEventListener('touchstart', handleTouchStart, { passive: false });\r\n\r\n            return () => {\r\n                button.removeEventListener('touchstart', handleTouchStart);\r\n            };\r\n        }\r\n    }, [isRecording]);\r\n\r\n    useEffect(() => {\r\n      if (isSettingsOpen) {\r\n        const fetchPromptLibrary = async () => {\r\n          try {\r\n            const response = await getPrompts();\r\n            setPromptLibrary(response.data);\r\n          } catch (err) {\r\n            console.error(\"Failed to fetch prompt library\", err);\r\n           }\r\n        };\r\n        fetchPromptLibrary();\r\n      }\r\n    }, [isSettingsOpen]);\r\n\r\n    const handleSwapLanguages = () => {\r\n        if (sourceLang === 'auto') return;\r\n        const newSourceLang = targetLang;\r\n        const newTargetLang = sourceLang;\r\n        setSourceLang(newSourceLang);\r\n        setTargetLang(newTargetLang);\r\n    };\r\n\r\n    const handleTranslate = async (e) => {\r\n        if (e) e.preventDefault();\r\n        if (!inputText.trim() || isLoading) return;\r\n\r\n        const tempId = Date.now();\r\n        const optimisticMessage = {\r\n            id: tempId,\r\n            original_text: inputText,\r\n            translated_text: \"جاري الترجمة...\",\r\n            created_at: new Date().toISOString(),\r\n            status: 'pending'\r\n        };\r\n\r\n        setMessages(prevMessages => [...prevMessages, optimisticMessage]);\r\n        setInputText('');\r\n        setIsLoading(true);\r\n        setError('');\r\n\r\n        try {\r\n            const targetLanguageName = targetLanguages.find(lang => lang.code === targetLang)?.name || 'English';\r\n            const response = await addMessageToConversation(id, optimisticMessage.original_text, targetLanguageName);\r\n            setMessages(prevMessages => \r\n                prevMessages.map(msg => msg.id === tempId ? response.data : msg)\r\n            );\r\n        } catch (apiError) {\r\n            console.error(\"API call failed:\", apiError);\r\n            const errorDetail = apiError.response?.data?.detail || \"فشل في إرسال الرسالة.\";\r\n            setError(errorDetail);\r\n            setMessages(prevMessages => \r\n                prevMessages.map(msg => msg.id === tempId ? { ...msg, status: 'error', translated_text: 'فشلت الترجمة' } : msg)\r\n            );\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteMessage = async (messageId) => {\r\n        if (window.confirm('هل أنت متأكد من حذف هذه الرسالة؟')) {\r\n            try {\r\n                await deleteMessage(messageId);\r\n                setMessages(prev => prev.filter(msg => msg.id !== messageId));\r\n            } catch (err) {\r\n                setError('فشل في حذف الرسالة.');\r\n                console.error(err);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleStartEditing = (message) => {\r\n        setEditingMessage({ id: message.id, text: message.original_text });\r\n    };\r\n\r\n    const handleCancelEditing = () => {\r\n        setEditingMessage({ id: null, text: '' });\r\n    };\r\n\r\n    const handleSaveEdit = async () => {\r\n        if (!editingMessage.text.trim()) return;\r\n        setIsLoading(true);\r\n        try {\r\n            const response = await editMessage(editingMessage.id, editingMessage.text);\r\n            setMessages(prev => prev.map(msg => msg.id === editingMessage.id ? response.data : msg));\r\n            handleCancelEditing();\r\n        } catch (err) {\r\n            setError('فشل في تعديل الرسالة.');\r\n            console.error(err);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePlayAudio = async (text, messageId) => {\r\n        if (playingAudioId === messageId) {\r\n            if (audioRef.current) {\r\n                audioRef.current.pause();\r\n                audioRef.current.currentTime = 0;\r\n            }\r\n            setPlayingAudioId(null);\r\n            return;\r\n        }\r\n\r\n        setPlayingAudioId(messageId);\r\n        try {\r\n            const response = await callTextToSpeechApi(text);\r\n            const audioBlob = response.data;\r\n            const audioUrl = URL.createObjectURL(audioBlob);\r\n            const audio = new Audio(audioUrl);\r\n            audioRef.current = audio;\r\n            audio.play();\r\n            audio.onended = () => { setPlayingAudioId(null); };\r\n            audio.onerror = (e) => {\r\n                console.error(\"Audio playback error:\", e);\r\n                setError('حدث خطأ أثناء تشغيل الصوت.');\r\n                setPlayingAudioId(null);\r\n            }\r\n        } catch (err) {\r\n            setError('فشل في توليد الصوت.');\r\n            setPlayingAudioId(null);\r\n        }\r\n    };\r\n\r\n    const handleSaveSettings = async () => {\r\n        setSaveSettingsStatus('جاري الحفظ...');\r\n        try {\r\n            const settingsToUpdate = {\r\n                use_context: currentUseContext,\r\n                custom_prompt: currentCustomPrompt,\r\n            };\r\n            const response = await updateConversationSettings(id, settingsToUpdate);\r\n            setConversation(response.data);\r\n            setSaveSettingsStatus('تم الحفظ بنجاح!');\r\n            setTimeout(() => {\r\n                setIsSettingsOpen(false);\r\n                setSaveSettingsStatus('');\r\n            }, 1500);\r\n        } catch (err) {\r\n            setSaveSettingsStatus('فشل الحفظ. حاول مرة أخرى.');\r\n            console.error(\"Failed to save settings:\", err);\r\n        }\r\n    };\r\n\r\n    // **التعديل**: تحديث دالة النسخ لتقبل نوع النص\r\n    const handleCopyText = (text, messageId, type) => {\r\n        navigator.clipboard.writeText(text).then(() => {\r\n            setCopyStatus({ id: messageId, type: type });\r\n            setTimeout(() => setCopyStatus({ id: null, type: null }), 2000);\r\n        }, (err) => {\r\n            console.error('Could not copy text: ', err);\r\n            setError('فشل نسخ النص.');\r\n        });\r\n    };\r\n\r\n    const handleShareText = async (text) => {\r\n        if (navigator.share) {\r\n            try {\r\n                await navigator.share({\r\n                    title: 'ترجمة من المترجم الذكي',\r\n                    text: text,\r\n                });\r\n            } catch (err) {\r\n                console.error('Error sharing:', err);\r\n            }\r\n        } else {\r\n            setError('المشاركة غير مدعومة في هذا المتصفح.');\r\n        }\r\n    };\r\n\r\n    const handleDownloadAudio = async (text) => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            const response = await callTextToSpeechApi(text);\r\n            const audioBlob = response.data;\r\n            const url = window.URL.createObjectURL(audioBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', `translation-${Date.now()}.mp3`);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.parentNode.removeChild(link);\r\n            window.URL.revokeObjectURL(url);\r\n        } catch (err) {\r\n            setError('فشل في تنزيل الملف الصوتي.');\r\n            console.error(err);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleExport = async () => {\r\n        try {\r\n            const response = await exportConversation(id);\r\n            const textBlob = new Blob([response.data], { type: 'text/plain;charset=utf-8' });\r\n            const url = window.URL.createObjectURL(textBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', `${conversation.title.replace(/\\s/g, '_')}.txt`);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.parentNode.removeChild(link);\r\n            window.URL.revokeObjectURL(url);\r\n        } catch (err) {\r\n            setError('فشل في تصدير المحادثة.');\r\n            console.error(\"Failed to export conversation:\", err);\r\n        }\r\n    };\r\n\r\n    const transcribeFile = async (file) => {\r\n        if (!file) return;\r\n        setIsTranscribing(true);\r\n        setError('');\r\n        try {\r\n            const response = await transcribeAudio(file);\r\n            setInputText(prev => prev.trim() ? prev + ' ' + response.data.transcribed_text : response.data.transcribed_text);\r\n        } catch (err) {\r\n            const errorDetail = err.response?.data?.detail || 'فشل في تحويل الصوت إلى نص.';\r\n            setError(errorDetail);\r\n            console.error(\"Transcription failed:\", err);\r\n        } finally {\r\n            setIsTranscribing(false);\r\n        }\r\n    };\r\n\r\n    const handleStartRecording = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        if (isRecording || isTranscribing) return;\r\n        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n            try {\r\n                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n                setIsRecording(true);\r\n                mediaRecorderRef.current = new MediaRecorder(stream);\r\n                mediaRecorderRef.current.ondataavailable = (event) => {\r\n                    audioChunksRef.current.push(event.data);\r\n                };\r\n                mediaRecorderRef.current.onstop = async () => {\r\n                    const audioBlob = new Blob(audioChunksRef.current, { type: 'audio/webm' });\r\n                    audioChunksRef.current = [];\r\n                    stream.getTracks().forEach(track => track.stop());\r\n                    if(audioBlob.size > 0) {\r\n                        await transcribeFile(audioBlob);\r\n                    }\r\n                };\r\n                mediaRecorderRef.current.start();\r\n            } catch (err) {\r\n                console.error(\"Error accessing microphone:\", err);\r\n                setError(\"لا يمكن الوصول إلى الميكروفون. يرجى التحقق من الأذونات.\");\r\n                setIsRecording(false);\r\n            }\r\n        } else {\r\n            setError(\"المتصفح لا يدعم التسجيل الصوتي.\");\r\n        }\r\n    };\r\n\r\n    const handleStopRecording = (e) => {\r\n        e.preventDefault();\r\n        if (mediaRecorderRef.current && isRecording) {\r\n            mediaRecorderRef.current.stop();\r\n            setIsRecording(false);\r\n        }\r\n    };\r\n\r\n    const handleFileSelect = (event) => {\r\n        const file = event.target.files[0];\r\n        if (file) {\r\n            transcribeFile(file);\r\n        }\r\n        event.target.value = null; \r\n    };\r\n\r\n    const handleUploadClick = () => {\r\n        if (isTranscribing) return;\r\n        fileInputRef.current.click();\r\n    };\r\n\r\n    const renderInputActions = () => {\r\n        if (isTranscribing) {\r\n            return (\r\n                <button type=\"button\" className=\"mic-button\" disabled>\r\n                    <FaSpinner className=\"fa-spin\" />\r\n                </button>\r\n            );\r\n        }\r\n        if (inputText.trim()) {\r\n            return (\r\n                <button type=\"submit\" className=\"translate-button\" disabled={isLoading}>\r\n                    {isLoading ? <FaSpinner className=\"fa-spin\"/> : <FaPaperPlane />}\r\n                </button>\r\n            );\r\n        }\r\n        return (\r\n            <>\r\n                <button type=\"button\" className=\"mic-button\" onClick={handleUploadClick} title=\"تحميل ملف صوتي\">\r\n                    <FaPaperclip />\r\n                </button>\r\n                <button \r\n                    ref={micButtonRef}\r\n                    type=\"button\" \r\n                    className={`mic-button ${isRecording ? 'recording' : ''}`} \r\n                    onMouseDown={handleStartRecording}\r\n                    onMouseUp={handleStopRecording}\r\n                    onTouchEnd={handleStopRecording}\r\n                    title=\"اضغط باستمرار للتسجيل\"\r\n                >\r\n                    {isRecording ? <FaStop /> : <FaMicrophone />}\r\n                </button>\r\n            </>\r\n        );\r\n    };\r\n\r\n    if (!conversation) {\r\n        return <div className=\"page-container\">جاري تحميل المحادثة...</div>;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className=\"page-container workspace-container\">\r\n                <div className=\"workspace-header\">\r\n                    <div className=\"header-top-row\">\r\n                        <h1>{conversation.title}</h1>\r\n                        <div className=\"header-actions\">\r\n                             <button className=\"icon-button\" onClick={handleExport} title=\"تصدير المحادثة\">\r\n                                <FaFileExport />\r\n                            </button>\r\n                            <button className=\"icon-button\" onClick={() => setIsSettingsOpen(true)} title=\"إعدادات المحادثة\">\r\n                                <FaCog />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"header-bottom-row\">\r\n                         <input \r\n                            type=\"text\"\r\n                            placeholder=\"ابحث في الرسائل...\"\r\n                            className=\"message-search-bar\"\r\n                            value={messageSearchQuery}\r\n                            onChange={(e) => setMessageSearchQuery(e.target.value)}\r\n                        />\r\n                        <div className=\"language-controls\">\r\n                            <select className=\"language-select\" value={sourceLang} onChange={(e) => setSourceLang(e.target.value)}>\r\n                                {sourceLanguages.map(lang => (\r\n                                    <option key={lang.code} value={lang.code}>{lang.name}</option>\r\n                                ))}\r\n                            </select>\r\n                            <button className=\"swap-languages-button\" onClick={handleSwapLanguages} title=\"تبديل اللغات\" disabled={sourceLang === 'auto'}>\r\n                                <FaExchangeAlt />\r\n                            </button>\r\n                             <select className=\"language-select\" value={targetLang} onChange={(e) => setTargetLang(e.target.value)}>\r\n                                {targetLanguages.map(lang => (\r\n                                    <option key={lang.code} value={lang.code}>{lang.name}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div className=\"message-history\">\r\n                    {messages.map((msg) => (\r\n                        <div key={msg.id} className={`message-pair ${msg.status || ''}`}>\r\n                            <div className=\"message original-message\">\r\n                                {editingMessage.id === msg.id ? (\r\n                                    <div className=\"edit-container\">\r\n                                        <textarea className=\"edit-textarea\" value={editingMessage.text} onChange={(e) => setEditingMessage({ ...editingMessage, text: e.target.value })} autoFocus />\r\n                                        <div className=\"edit-buttons\">\r\n                                            <button className=\"button-primary\" onClick={handleSaveEdit} disabled={isLoading}>{isLoading ? 'جاري...' : 'حفظ'}</button>\r\n                                            <button onClick={handleCancelEditing}>إلغاء</button>\r\n                                        </div>\r\n                                    </div>\r\n                                ) : (\r\n                                    <>\r\n                                        <span className=\"message-content\">{highlightText(msg.original_text, messageSearchQuery)}</span>\r\n                                        <div className=\"message-actions\">\r\n                                            {/* **الإضافة**: زر النسخ الجديد للنص الأصلي */}\r\n                                            <button onClick={() => handleCopyText(msg.original_text, msg.id, 'original')} title=\"نسخ\">\r\n                                                {copyStatus.id === msg.id && copyStatus.type === 'original' ? 'تم!' : <FaCopy />}\r\n                                            </button>\r\n                                            <button onClick={() => handleStartEditing(msg)} title=\"تعديل\"><FaEdit /></button>\r\n                                            <button onClick={() => handleDeleteMessage(msg.id)} title=\"حذف\"><FaTrash /></button>\r\n                                        </div>\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                            <div className=\"message translated-message\">\r\n                                <span className=\"message-content\">\r\n                                    {msg.status === 'pending' && <FaSpinner className=\"fa-spin message-spinner\" />}\r\n                                    {highlightText(msg.translated_text, messageSearchQuery)}\r\n                                </span>\r\n                                {msg.status !== 'pending' && msg.status !== 'error' && (\r\n                                  <div className=\"message-actions\">\r\n                                      <button onClick={() => handleCopyText(msg.translated_text, msg.id, 'translated')} title=\"نسخ النص\">\r\n                                        {copyStatus.id === msg.id && copyStatus.type === 'translated' ? 'تم النسخ!' : <FaCopy />}\r\n                                    </button>\r\n                                    <button className=\"play-audio-button\" onClick={() => handlePlayAudio(msg.translated_text, msg.id)} title=\"الاستماع للترجمة\">\r\n                                        {playingAudioId === msg.id ? <FaSpinner className=\"fa-spin\" /> : <FaVolumeUp />}\r\n                                    </button>\r\n                                    <button onClick={() => handleDownloadAudio(msg.translated_text)} title=\"تنزيل الصوت\">\r\n                                        <FaDownload />\r\n                                    </button>\r\n                                    {navigator.share && (\r\n                                      <button onClick={() => handleShareText(msg.translated_text)} title=\"مشاركة النص\">\r\n                                            <FaShareAlt />\r\n                                        </button>\r\n                                    )}\r\n                                  </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                    <div ref={messagesEndRef} />\r\n                </div>\r\n\r\n                {error && <div className=\"status-message error\" onClick={() => setError('')}>{error}</div>}\r\n                \r\n                <form className=\"translation-input-area\" onSubmit={handleTranslate}>\r\n                    <TextareaAutosize \r\n                        className=\"text-area\" \r\n                        value={inputText} \r\n                        onChange={(e) => setInputText(e.target.value)} \r\n                        placeholder={isTranscribing ? \"جاري تفريغ الصوت...\" : \"اكتب النص...\"}\r\n                        onKeyDown={(e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleTranslate(null); } }} \r\n                        minRows={1}\r\n                        maxRows={6}\r\n                        cacheMeasurements\r\n                        disabled={isTranscribing}\r\n                    />\r\n                    \r\n                    <input\r\n                        type=\"file\"\r\n                        ref={fileInputRef}\r\n                        onChange={handleFileSelect}\r\n                        style={{ display: 'none' }}\r\n                        accept=\"audio/*\"\r\n                    />\r\n                    \r\n                    {renderInputActions()}\r\n\r\n                </form>\r\n            </div>\r\n            {isSettingsOpen && (\r\n                <div className=\"modal-overlay\">\r\n                    <div className=\"modal-content\">\r\n                        <div className=\"modal-header\">\r\n                            <h2>إعدادات المحادثة</h2>\r\n                            <button className=\"modal-close-button\" onClick={() => setIsSettingsOpen(false)}><FaTimes /></button>\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>تفعيل سياق المحادثة</label>\r\n                            <div className=\"toggle-switch\">\r\n                                <input type=\"checkbox\" id=\"context-toggle\" checked={currentUseContext} onChange={(e) => setCurrentUseContext(e.target.checked)} />\r\n                                <label htmlFor=\"context-toggle\" className=\"switch-label\">Toggle</label>\r\n                                <span>{currentUseContext ? \"مفعل\" : \"معطل\"}</span>\r\n                            </div>\r\n                            <p className=\"description\">عند التفعيل، سيتم إرسال الرسائل السابقة مع كل طلب جديد لتحسين دقة الترجمة.</p>\r\n                        </div>\r\n                         \r\n                        <div className=\"form-group\">\r\n                            <label htmlFor=\"custom-prompt-select\">برومبت مخصص</label>\r\n                            <select \r\n                                id=\"custom-prompt-select\"\r\n                                className=\"form-input\"\r\n                                value={currentCustomPrompt}\r\n                                onChange={(e) => setCurrentCustomPrompt(e.target.value)}\r\n                            >\r\n                                <option value=\"\">بدون برومبت</option>\r\n                                {promptLibrary.map(prompt => (\r\n                                    <option key={prompt.id} value={prompt.content}>\r\n                                        {prompt.title}\r\n                                    </option>\r\n                                ))}\r\n                            </select>\r\n                            <p className=\"description\">اختر برومبت جاهز من مكتبتك لتطبيقه على هذه المحادثة.</p>\r\n                        </div>\r\n\r\n                        <button className=\"button-primary\" onClick={handleSaveSettings}>حفظ الإعدادات</button>\r\n                        {saveSettingsStatus && <p className=\"status-message\" style={{ color: 'green' }}>{saveSettingsStatus}</p>}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default WorkspacePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}