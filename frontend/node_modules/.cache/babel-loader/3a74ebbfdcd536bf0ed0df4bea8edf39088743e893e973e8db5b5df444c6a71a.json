{"ast":null,"code":"var _jsxFileName = \"D:\\\\intelligent translator\\\\frontend\\\\src\\\\pages\\\\WorkspacePage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport { getConversationById, addMessageToConversation, updateConversationSettings, callTextToSpeechApi, editMessage, deleteMessage, exportConversation, transcribeAudio, getPrompts } from '../apiClient';\nimport { FaPaperPlane, FaVolumeUp, FaSpinner, FaExchangeAlt, FaCog, FaTimes, FaEdit, FaTrash, FaCopy, FaDownload, FaShareAlt, FaFileExport, FaMicrophone, FaStop, FaPaperclip } from 'react-icons/fa';\nimport './WorkspacePage.scss';\n\n// --- Language definitions ---\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst sourceLanguages = [{\n  code: 'auto',\n  name: 'اكتشاف تلقائي'\n}, {\n  code: 'ar',\n  name: 'العربية'\n}, {\n  code: 'en',\n  name: 'English'\n}, {\n  code: 'fr',\n  name: 'Français'\n}, {\n  code: 'de',\n  name: 'Deutsch'\n}, {\n  code: 'es',\n  name: 'Español'\n}];\nconst targetLanguages = [{\n  code: 'en',\n  name: 'English'\n}, {\n  code: 'ar',\n  name: 'العربية'\n}, {\n  code: 'fr',\n  name: 'Français'\n}, {\n  code: 'de',\n  name: 'Deutsch'\n}, {\n  code: 'es',\n  name: 'Español'\n}];\n\n// Helper function for highlighting search results\nconst highlightText = (text, query) => {\n  if (!query) {\n    return text;\n  }\n  const parts = text.split(new RegExp(`(${query})`, 'gi'));\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    children: parts.map((part, index) => part.toLowerCase() === query.toLowerCase() ? /*#__PURE__*/_jsxDEV(\"mark\", {\n      children: part\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 11\n    }, this) : part)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n};\nfunction WorkspacePage() {\n  _s();\n  const {\n    id\n  } = useParams();\n  const [conversation, setConversation] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [inputText, setInputText] = useState('');\n  const [isLoading, setIsLoading] = useState(false); // For translation\n  const [isTranscribing, setIsTranscribing] = useState(false); // <-- NEW: State for transcription\n  const [error, setError] = useState('');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [sourceLang, setSourceLang] = useState('auto');\n  const [targetLang, setTargetLang] = useState('en');\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n  const [currentUseContext, setCurrentUseContext] = useState(true);\n  const [currentCustomPrompt, setCurrentCustomPrompt] = useState('');\n  const [saveSettingsStatus, setSaveSettingsStatus] = useState('');\n  const [editingMessage, setEditingMessage] = useState({\n    id: null,\n    text: ''\n  });\n  const [messageSearchQuery, setMessageSearchQuery] = useState('');\n  const [copiedMessageId, setCopiedMessageId] = useState(null);\n  const [isRecording, setIsRecording] = useState(false);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const micButtonRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const [promptLibrary, setPromptLibrary] = useState([]);\n  const messagesEndRef = useRef(null);\n  const audioRef = useRef(null);\n  useEffect(() => {\n    const fetchConversation = async () => {\n      try {\n        const response = await getConversationById(id);\n        setConversation(response.data);\n        setMessages(response.data.messages);\n        setCurrentUseContext(response.data.use_context);\n        setCurrentCustomPrompt(response.data.custom_prompt || '');\n      } catch (err) {\n        setError('فشل في تحميل المحادثة.');\n        console.error(err);\n      }\n    };\n    if (id) {\n      fetchConversation();\n    }\n  }, [id]);\n  useEffect(() => {\n    if (!messageSearchQuery) {\n      var _messagesEndRef$curre;\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    }\n  }, [messages, messageSearchQuery]);\n  useEffect(() => {\n    const button = micButtonRef.current;\n    if (button) {\n      const handleTouchStart = e => {\n        handleStartRecording(e);\n      };\n      button.addEventListener('touchstart', handleTouchStart, {\n        passive: false\n      });\n      return () => {\n        button.removeEventListener('touchstart', handleTouchStart);\n      };\n    }\n  }, [isRecording]);\n  useEffect(() => {\n    if (isSettingsOpen) {\n      const fetchPromptLibrary = async () => {\n        try {\n          const response = await getPrompts();\n          setPromptLibrary(response.data);\n        } catch (err) {\n          console.error(\"Failed to fetch prompt library\", err);\n        }\n      };\n      fetchPromptLibrary();\n    }\n  }, [isSettingsOpen]);\n  const handleSwapLanguages = () => {\n    if (sourceLang === 'auto') return;\n    const newSourceLang = targetLang;\n    const newTargetLang = sourceLang;\n    setSourceLang(newSourceLang);\n    setTargetLang(newTargetLang);\n  };\n  const handleTranslate = async e => {\n    if (e) e.preventDefault();\n    if (!inputText.trim() || isLoading) return;\n    setIsLoading(true);\n    setError('');\n    try {\n      var _targetLanguages$find;\n      const targetLanguageName = ((_targetLanguages$find = targetLanguages.find(lang => lang.code === targetLang)) === null || _targetLanguages$find === void 0 ? void 0 : _targetLanguages$find.name) || 'English';\n      const response = await addMessageToConversation(id, inputText, targetLanguageName);\n      setMessages(prevMessages => [...prevMessages, response.data]);\n      setInputText('');\n    } catch (apiError) {\n      var _apiError$response, _apiError$response$da;\n      console.error(\"API call failed:\", apiError);\n      setError(((_apiError$response = apiError.response) === null || _apiError$response === void 0 ? void 0 : (_apiError$response$da = _apiError$response.data) === null || _apiError$response$da === void 0 ? void 0 : _apiError$response$da.detail) || \"فشل في إرسال الرسالة.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleDeleteMessage = async messageId => {\n    if (window.confirm('هل أنت متأكد من حذف هذه الرسالة؟')) {\n      try {\n        await deleteMessage(messageId);\n        setMessages(prev => prev.filter(msg => msg.id !== messageId));\n      } catch (err) {\n        setError('فشل في حذف الرسالة.');\n        console.error(err);\n      }\n    }\n  };\n  const handleStartEditing = message => {\n    setEditingMessage({\n      id: message.id,\n      text: message.original_text\n    });\n  };\n  const handleCancelEditing = () => {\n    setEditingMessage({\n      id: null,\n      text: ''\n    });\n  };\n  const handleSaveEdit = async () => {\n    if (!editingMessage.text.trim()) return;\n    setIsLoading(true);\n    try {\n      const response = await editMessage(editingMessage.id, editingMessage.text);\n      setMessages(prev => prev.map(msg => msg.id === editingMessage.id ? response.data : msg));\n      handleCancelEditing();\n    } catch (err) {\n      setError('فشل في تعديل الرسالة.');\n      console.error(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handlePlayAudio = async (text, messageId) => {\n    if (playingAudioId === messageId) {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current.currentTime = 0;\n      }\n      setPlayingAudioId(null);\n      return;\n    }\n    setPlayingAudioId(messageId);\n    try {\n      const response = await callTextToSpeechApi(text);\n      const audioBlob = response.data;\n      const audioUrl = URL.createObjectURL(audioBlob);\n      const audio = new Audio(audioUrl);\n      audioRef.current = audio;\n      audio.play();\n      audio.onended = () => {\n        setPlayingAudioId(null);\n      };\n      audio.onerror = e => {\n        console.error(\"Audio playback error:\", e);\n        setError('حدث خطأ أثناء تشغيل الصوت.');\n        setPlayingAudioId(null);\n      };\n    } catch (err) {\n      setError('فشل في توليد الصوت.');\n      setPlayingAudioId(null);\n    }\n  };\n  const handleSaveSettings = async () => {\n    setSaveSettingsStatus('جاري الحفظ...');\n    try {\n      const settingsToUpdate = {\n        use_context: currentUseContext,\n        custom_prompt: currentCustomPrompt\n      };\n      const response = await updateConversationSettings(id, settingsToUpdate);\n      setConversation(response.data);\n      setSaveSettingsStatus('تم الحفظ بنجاح!');\n      setTimeout(() => {\n        setIsSettingsOpen(false);\n        setSaveSettingsStatus('');\n      }, 1500);\n    } catch (err) {\n      setSaveSettingsStatus('فشل الحفظ. حاول مرة أخرى.');\n      console.error(\"Failed to save settings:\", err);\n    }\n  };\n  const handleCopyText = (text, messageId) => {\n    navigator.clipboard.writeText(text).then(() => {\n      setCopiedMessageId(messageId);\n      setTimeout(() => setCopiedMessageId(null), 2000);\n    }, err => {\n      console.error('Could not copy text: ', err);\n      setError('فشل نسخ النص.');\n    });\n  };\n  const handleShareText = async text => {\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: 'ترجمة من المترجم الذكي',\n          text: text\n        });\n      } catch (err) {\n        console.error('Error sharing:', err);\n      }\n    } else {\n      setError('المشاركة غير مدعومة في هذا المتصفح.');\n    }\n  };\n  const handleDownloadAudio = async text => {\n    setIsLoading(true);\n    setError('');\n    try {\n      const response = await callTextToSpeechApi(text);\n      const audioBlob = response.data;\n      const url = window.URL.createObjectURL(audioBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', `translation-${Date.now()}.mp3`);\n      document.body.appendChild(link);\n      link.click();\n      link.parentNode.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (err) {\n      setError('فشل في تنزيل الملف الصوتي.');\n      console.error(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleExport = async () => {\n    try {\n      const response = await exportConversation(id);\n      const textBlob = new Blob([response.data], {\n        type: 'text/plain;charset=utf-8'\n      });\n      const url = window.URL.createObjectURL(textBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', `${conversation.title.replace(/\\s/g, '_')}.txt`);\n      document.body.appendChild(link);\n      link.click();\n      link.parentNode.removeChild(link);\n      window.URL.revokeObjectURL(url);\n    } catch (err) {\n      setError('فشل في تصدير المحادثة.');\n      console.error(\"Failed to export conversation:\", err);\n    }\n  };\n\n  // --- UPDATED: Combined Audio Handling Logic with new state ---\n\n  const transcribeFile = async file => {\n    if (!file) return;\n    setIsTranscribing(true); // <-- Use new state\n    setError('');\n    try {\n      const response = await transcribeAudio(file);\n      setInputText(prev => prev.trim() ? prev + ' ' + response.data.transcribed_text : response.data.transcribed_text);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      const errorDetail = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || 'فشل في تحويل الصوت إلى نص.';\n      setError(errorDetail);\n      console.error(\"Transcription failed:\", err);\n    } finally {\n      setIsTranscribing(false); // <-- Use new state\n    }\n  };\n  const handleStartRecording = async e => {\n    e.preventDefault();\n    setError('');\n    if (isRecording || isTranscribing) return; // Prevent action if already transcribing\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          audio: true\n        });\n        setIsRecording(true);\n        mediaRecorderRef.current = new MediaRecorder(stream);\n        mediaRecorderRef.current.ondataavailable = event => {\n          audioChunksRef.current.push(event.data);\n        };\n        mediaRecorderRef.current.onstop = async () => {\n          const audioBlob = new Blob(audioChunksRef.current, {\n            type: 'audio/webm'\n          });\n          audioChunksRef.current = [];\n          stream.getTracks().forEach(track => track.stop());\n          if (audioBlob.size > 0) {\n            await transcribeFile(audioBlob);\n          }\n        };\n        mediaRecorderRef.current.start();\n      } catch (err) {\n        console.error(\"Error accessing microphone:\", err);\n        setError(\"لا يمكن الوصول إلى الميكروفون. يرجى التحقق من الأذونات.\");\n        setIsRecording(false);\n      }\n    } else {\n      setError(\"المتصفح لا يدعم التسجيل الصوتي.\");\n    }\n  };\n  const handleStopRecording = e => {\n    e.preventDefault();\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n    }\n  };\n  const handleFileSelect = event => {\n    const file = event.target.files[0];\n    if (file) {\n      transcribeFile(file);\n    }\n    event.target.value = null;\n  };\n  const handleUploadClick = () => {\n    if (isTranscribing) return;\n    fileInputRef.current.click();\n  };\n  if (!conversation) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-container\",\n      children: \"\\u062C\\u0627\\u0631\\u064A \\u062A\\u062D\\u0645\\u064A\\u0644 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 16\n    }, this);\n  }\n\n  // --- NEW: Logic to render the correct button in the input area ---\n  const renderInputActions = () => {\n    if (isTranscribing) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"mic-button\",\n        disabled: true,\n        children: /*#__PURE__*/_jsxDEV(FaSpinner, {\n          className: \"fa-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 17\n      }, this);\n    }\n    if (inputText.trim()) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"translate-button\",\n        disabled: isLoading,\n        children: isLoading ? /*#__PURE__*/_jsxDEV(FaSpinner, {\n          className: \"fa-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 34\n        }, this) : /*#__PURE__*/_jsxDEV(FaPaperPlane, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 69\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 17\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"mic-button\",\n        onClick: handleUploadClick,\n        title: \"\\u062A\\u062D\\u0645\\u064A\\u0644 \\u0645\\u0644\\u0641 \\u0635\\u0648\\u062A\\u064A\",\n        children: /*#__PURE__*/_jsxDEV(FaPaperclip, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        ref: micButtonRef,\n        type: \"button\",\n        className: `mic-button ${isRecording ? 'recording' : ''}`,\n        onMouseDown: handleStartRecording,\n        onMouseUp: handleStopRecording,\n        onTouchEnd: handleStopRecording,\n        title: \"\\u0627\\u0636\\u063A\\u0637 \\u0628\\u0627\\u0633\\u062A\\u0645\\u0631\\u0627\\u0631 \\u0644\\u0644\\u062A\\u0633\\u062C\\u064A\\u0644\",\n        children: isRecording ? /*#__PURE__*/_jsxDEV(FaStop, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 36\n        }, this) : /*#__PURE__*/_jsxDEV(FaMicrophone, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 49\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-container workspace-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"workspace-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-top-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: conversation.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"icon-button\",\n              onClick: handleExport,\n              title: \"\\u062A\\u0635\\u062F\\u064A\\u0631 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\",\n              children: /*#__PURE__*/_jsxDEV(FaFileExport, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 30\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"icon-button\",\n              onClick: () => setIsSettingsOpen(true),\n              title: \"\\u0625\\u0639\\u062F\\u0627\\u062F\\u0627\\u062A \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\",\n              children: /*#__PURE__*/_jsxDEV(FaCog, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 447,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-bottom-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: \"\\u0627\\u0628\\u062D\\u062B \\u0641\\u064A \\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644...\",\n            className: \"message-search-bar\",\n            value: messageSearchQuery,\n            onChange: e => setMessageSearchQuery(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"language-controls\",\n            children: [/*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"language-select\",\n              value: sourceLang,\n              onChange: e => setSourceLang(e.target.value),\n              children: sourceLanguages.map(lang => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: lang.code,\n                children: lang.name\n              }, lang.code, false, {\n                fileName: _jsxFileName,\n                lineNumber: 462,\n                columnNumber: 37\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"swap-languages-button\",\n              onClick: handleSwapLanguages,\n              title: \"\\u062A\\u0628\\u062F\\u064A\\u0644 \\u0627\\u0644\\u0644\\u063A\\u0627\\u062A\",\n              disabled: sourceLang === 'auto',\n              children: /*#__PURE__*/_jsxDEV(FaExchangeAlt, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"language-select\",\n              value: targetLang,\n              onChange: e => setTargetLang(e.target.value),\n              children: targetLanguages.map(lang => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: lang.code,\n                children: lang.name\n              }, lang.code, false, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 37\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 30\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message-history\",\n        children: [messages.map(msg => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-pair\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message original-message\",\n            children: editingMessage.id === msg.id ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"edit-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                className: \"edit-textarea\",\n                value: editingMessage.text,\n                onChange: e => setEditingMessage({\n                  ...editingMessage,\n                  text: e.target.value\n                }),\n                autoFocus: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 484,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"edit-buttons\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"button-primary\",\n                  onClick: handleSaveEdit,\n                  disabled: isLoading,\n                  children: isLoading ? 'جاري...' : 'حفظ'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 486,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleCancelEditing,\n                  children: \"\\u0625\\u0644\\u063A\\u0627\\u0621\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 487,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 485,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 37\n            }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"message-content\",\n                children: highlightText(msg.original_text, messageSearchQuery)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"message-actions\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleStartEditing(msg),\n                  title: \"\\u062A\\u0639\\u062F\\u064A\\u0644\",\n                  children: /*#__PURE__*/_jsxDEV(FaEdit, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 494,\n                    columnNumber: 107\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleDeleteMessage(msg.id),\n                  title: \"\\u062D\\u0630\\u0641\",\n                  children: /*#__PURE__*/_jsxDEV(FaTrash, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 495,\n                    columnNumber: 109\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 495,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 493,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 481,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message translated-message\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"message-content\",\n              children: highlightText(msg.translated_text, messageSearchQuery)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleCopyText(msg.translated_text, msg.id),\n                title: \"\\u0646\\u0633\\u062E \\u0627\\u0644\\u0646\\u0635\",\n                children: copiedMessageId === msg.id ? 'تم النسخ!' : /*#__PURE__*/_jsxDEV(FaCopy, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 504,\n                  columnNumber: 85\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"play-audio-button\",\n                onClick: () => handlePlayAudio(msg.translated_text, msg.id),\n                title: \"\\u0627\\u0644\\u0627\\u0633\\u062A\\u0645\\u0627\\u0639 \\u0644\\u0644\\u062A\\u0631\\u062C\\u0645\\u0629\",\n                children: playingAudioId === msg.id ? /*#__PURE__*/_jsxDEV(FaSpinner, {\n                  className: \"fa-spin\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 507,\n                  columnNumber: 70\n                }, this) : /*#__PURE__*/_jsxDEV(FaVolumeUp, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 507,\n                  columnNumber: 106\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 506,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleDownloadAudio(msg.translated_text),\n                title: \"\\u062A\\u0646\\u0632\\u064A\\u0644 \\u0627\\u0644\\u0635\\u0648\\u062A\",\n                children: /*#__PURE__*/_jsxDEV(FaDownload, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 510,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 509,\n                columnNumber: 37\n              }, this), navigator.share && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleShareText(msg.translated_text),\n                title: \"\\u0645\\u0634\\u0627\\u0631\\u0643\\u0629 \\u0627\\u0644\\u0646\\u0635\",\n                children: /*#__PURE__*/_jsxDEV(FaShareAlt, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 514,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 513,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 502,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 500,\n            columnNumber: 29\n          }, this)]\n        }, msg.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 25\n        }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 17\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-message error\",\n        onClick: () => setError(''),\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 27\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"translation-input-area\",\n        onSubmit: handleTranslate,\n        children: [/*#__PURE__*/_jsxDEV(TextareaAutosize, {\n          className: \"text-area\",\n          value: inputText,\n          onChange: e => setInputText(e.target.value),\n          placeholder: isTranscribing ? \"جاري تفريغ الصوت...\" : \"اكتب النص...\" // <-- Dynamic placeholder\n          ,\n          onKeyDown: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              handleTranslate(null);\n            }\n          },\n          minRows: 1,\n          maxRows: 6,\n          cacheMeasurements: true,\n          disabled: isTranscribing // <-- Disable textarea while transcribing\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          ref: fileInputRef,\n          onChange: handleFileSelect,\n          style: {\n            display: 'none'\n          },\n          accept: \"audio/*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 21\n        }, this), renderInputActions()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 526,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 437,\n      columnNumber: 13\n    }, this), isSettingsOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"\\u0625\\u0639\\u062F\\u0627\\u062F\\u0627\\u062A \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 557,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"modal-close-button\",\n            onClick: () => setIsSettingsOpen(false),\n            children: /*#__PURE__*/_jsxDEV(FaTimes, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 558,\n              columnNumber: 109\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 558,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u062A\\u0641\\u0639\\u064A\\u0644 \\u0633\\u064A\\u0627\\u0642 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 561,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"toggle-switch\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              id: \"context-toggle\",\n              checked: currentUseContext,\n              onChange: e => setCurrentUseContext(e.target.checked)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 563,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"context-toggle\",\n              className: \"switch-label\",\n              children: \"Toggle\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 564,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: currentUseContext ? \"مفعل\" : \"معطل\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 565,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"description\",\n            children: \"\\u0639\\u0646\\u062F \\u0627\\u0644\\u062A\\u0641\\u0639\\u064A\\u0644\\u060C \\u0633\\u064A\\u062A\\u0645 \\u0625\\u0631\\u0633\\u0627\\u0644 \\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644 \\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\\u0629 \\u0645\\u0639 \\u0643\\u0644 \\u0637\\u0644\\u0628 \\u062C\\u062F\\u064A\\u062F \\u0644\\u062A\\u062D\\u0633\\u064A\\u0646 \\u062F\\u0642\\u0629 \\u0627\\u0644\\u062A\\u0631\\u062C\\u0645\\u0629.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"custom-prompt-select\",\n            children: \"\\u0628\\u0631\\u0648\\u0645\\u0628\\u062A \\u0645\\u062E\\u0635\\u0635\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            id: \"custom-prompt-select\",\n            className: \"form-input\",\n            value: currentCustomPrompt,\n            onChange: e => setCurrentCustomPrompt(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"\\u0628\\u062F\\u0648\\u0646 \\u0628\\u0631\\u0648\\u0645\\u0628\\u062A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 578,\n              columnNumber: 33\n            }, this), promptLibrary.map(prompt => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: prompt.content,\n              children: prompt.title\n            }, prompt.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 580,\n              columnNumber: 37\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"description\",\n            children: \"\\u0627\\u062E\\u062A\\u0631 \\u0628\\u0631\\u0648\\u0645\\u0628\\u062A \\u062C\\u0627\\u0647\\u0632 \\u0645\\u0646 \\u0645\\u0643\\u062A\\u0628\\u062A\\u0643 \\u0644\\u062A\\u0637\\u0628\\u064A\\u0642\\u0647 \\u0639\\u0644\\u0649 \\u0647\\u0630\\u0647 \\u0627\\u0644\\u0645\\u062D\\u0627\\u062F\\u062B\\u0629.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button-primary\",\n          onClick: handleSaveSettings,\n          children: \"\\u062D\\u0641\\u0638 \\u0627\\u0644\\u0625\\u0639\\u062F\\u0627\\u062F\\u0627\\u062A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 25\n        }, this), saveSettingsStatus && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"status-message\",\n          style: {\n            color: 'green'\n          },\n          children: saveSettingsStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 48\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 554,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true);\n}\n_s(WorkspacePage, \"/welFLmU0VPzAzFvxc74C9zeWF8=\", false, function () {\n  return [useParams];\n});\n_c = WorkspacePage;\nexport default WorkspacePage;\nvar _c;\n$RefreshReg$(_c, \"WorkspacePage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","TextareaAutosize","getConversationById","addMessageToConversation","updateConversationSettings","callTextToSpeechApi","editMessage","deleteMessage","exportConversation","transcribeAudio","getPrompts","FaPaperPlane","FaVolumeUp","FaSpinner","FaExchangeAlt","FaCog","FaTimes","FaEdit","FaTrash","FaCopy","FaDownload","FaShareAlt","FaFileExport","FaMicrophone","FaStop","FaPaperclip","jsxDEV","_jsxDEV","Fragment","_Fragment","sourceLanguages","code","name","targetLanguages","highlightText","text","query","parts","split","RegExp","children","map","part","index","toLowerCase","fileName","_jsxFileName","lineNumber","columnNumber","WorkspacePage","_s","id","conversation","setConversation","messages","setMessages","inputText","setInputText","isLoading","setIsLoading","isTranscribing","setIsTranscribing","error","setError","playingAudioId","setPlayingAudioId","sourceLang","setSourceLang","targetLang","setTargetLang","isSettingsOpen","setIsSettingsOpen","currentUseContext","setCurrentUseContext","currentCustomPrompt","setCurrentCustomPrompt","saveSettingsStatus","setSaveSettingsStatus","editingMessage","setEditingMessage","messageSearchQuery","setMessageSearchQuery","copiedMessageId","setCopiedMessageId","isRecording","setIsRecording","mediaRecorderRef","audioChunksRef","micButtonRef","fileInputRef","promptLibrary","setPromptLibrary","messagesEndRef","audioRef","fetchConversation","response","data","use_context","custom_prompt","err","console","_messagesEndRef$curre","current","scrollIntoView","behavior","button","handleTouchStart","e","handleStartRecording","addEventListener","passive","removeEventListener","fetchPromptLibrary","handleSwapLanguages","newSourceLang","newTargetLang","handleTranslate","preventDefault","trim","_targetLanguages$find","targetLanguageName","find","lang","prevMessages","apiError","_apiError$response","_apiError$response$da","detail","handleDeleteMessage","messageId","window","confirm","prev","filter","msg","handleStartEditing","message","original_text","handleCancelEditing","handleSaveEdit","handlePlayAudio","pause","currentTime","audioBlob","audioUrl","URL","createObjectURL","audio","Audio","play","onended","onerror","handleSaveSettings","settingsToUpdate","setTimeout","handleCopyText","navigator","clipboard","writeText","then","handleShareText","share","title","handleDownloadAudio","url","link","document","createElement","href","setAttribute","Date","now","body","appendChild","click","parentNode","removeChild","revokeObjectURL","handleExport","textBlob","Blob","type","replace","transcribeFile","file","transcribed_text","_err$response","_err$response$data","errorDetail","mediaDevices","getUserMedia","stream","MediaRecorder","ondataavailable","event","push","onstop","getTracks","forEach","track","stop","size","start","handleStopRecording","handleFileSelect","target","files","value","handleUploadClick","className","renderInputActions","disabled","onClick","ref","onMouseDown","onMouseUp","onTouchEnd","placeholder","onChange","autoFocus","translated_text","onSubmit","onKeyDown","key","shiftKey","minRows","maxRows","cacheMeasurements","style","display","accept","checked","htmlFor","prompt","content","color","_c","$RefreshReg$"],"sources":["D:/intelligent translator/frontend/src/pages/WorkspacePage.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport TextareaAutosize from 'react-textarea-autosize';\r\nimport { \r\n  getConversationById, \r\n  addMessageToConversation, \r\n  updateConversationSettings, \r\n  callTextToSpeechApi,\r\n  editMessage,\r\n  deleteMessage,\r\n  exportConversation,\r\n  transcribeAudio,\r\n  getPrompts\r\n} from '../apiClient';\r\nimport { \r\n  FaPaperPlane, FaVolumeUp, FaSpinner, FaExchangeAlt, \r\n  FaCog, FaTimes, FaEdit, FaTrash,\r\n  FaCopy, FaDownload, FaShareAlt,\r\n  FaFileExport, FaMicrophone, FaStop, FaPaperclip\r\n} from 'react-icons/fa';\r\nimport './WorkspacePage.scss';\r\n\r\n// --- Language definitions ---\r\nconst sourceLanguages = [\r\n    { code: 'auto', name: 'اكتشاف تلقائي' },\r\n    { code: 'ar', name: 'العربية' },\r\n    { code: 'en', name: 'English' },\r\n    { code: 'fr', name: 'Français' },\r\n    { code: 'de', name: 'Deutsch' },\r\n    { code: 'es', name: 'Español' },\r\n];\r\n\r\nconst targetLanguages = [\r\n    { code: 'en', name: 'English' },\r\n    { code: 'ar', name: 'العربية' },\r\n    { code: 'fr', name: 'Français' },\r\n    { code: 'de', name: 'Deutsch' },\r\n    { code: 'es', name: 'Español' },\r\n];\r\n\r\n\r\n// Helper function for highlighting search results\r\nconst highlightText = (text, query) => {\r\n  if (!query) {\r\n    return text;\r\n  }\r\n  const parts = text.split(new RegExp(`(${query})`, 'gi'));\r\n  return (\r\n    <span>\r\n      {parts.map((part, index) =>\r\n        part.toLowerCase() === query.toLowerCase() ? (\r\n          <mark key={index}>{part}</mark>\r\n        ) : (\r\n          part\r\n        )\r\n      )}\r\n    </span>\r\n  );\r\n};\r\n\r\n\r\nfunction WorkspacePage() {\r\n    const { id } = useParams();\r\n    const [conversation, setConversation] = useState(null);\r\n    const [messages, setMessages] = useState([]);\r\n    const [inputText, setInputText] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false); // For translation\r\n    const [isTranscribing, setIsTranscribing] = useState(false); // <-- NEW: State for transcription\r\n    const [error, setError] = useState('');\r\n    const [playingAudioId, setPlayingAudioId] = useState(null);\r\n    \r\n    const [sourceLang, setSourceLang] = useState('auto');\r\n    const [targetLang, setTargetLang] = useState('en');\r\n\r\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\r\n    const [currentUseContext, setCurrentUseContext] = useState(true);\r\n    const [currentCustomPrompt, setCurrentCustomPrompt] = useState('');\r\n    const [saveSettingsStatus, setSaveSettingsStatus] = useState('');\r\n    const [editingMessage, setEditingMessage] = useState({ id: null, text: '' });\r\n    const [messageSearchQuery, setMessageSearchQuery] = useState('');\r\n    const [copiedMessageId, setCopiedMessageId] = useState(null);\r\n    \r\n    const [isRecording, setIsRecording] = useState(false);\r\n    const mediaRecorderRef = useRef(null);\r\n    const audioChunksRef = useRef([]);\r\n    const micButtonRef = useRef(null);\r\n    const fileInputRef = useRef(null);\r\n\r\n    const [promptLibrary, setPromptLibrary] = useState([]);\r\n\r\n    const messagesEndRef = useRef(null);\r\n    const audioRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const fetchConversation = async () => {\r\n            try {\r\n                const response = await getConversationById(id);\r\n                setConversation(response.data);\r\n                setMessages(response.data.messages);\r\n                setCurrentUseContext(response.data.use_context);\r\n                setCurrentCustomPrompt(response.data.custom_prompt || '');\r\n            } catch (err) {\r\n                setError('فشل في تحميل المحادثة.');\r\n                console.error(err);\r\n            }\r\n        };\r\n        if (id) {\r\n            fetchConversation();\r\n        }\r\n    }, [id]);\r\n\r\n    useEffect(() => {\r\n        if (!messageSearchQuery) {\r\n            messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n        }\r\n    }, [messages, messageSearchQuery]);\r\n    \r\n    useEffect(() => {\r\n        const button = micButtonRef.current;\r\n        if (button) {\r\n            const handleTouchStart = (e) => {\r\n                handleStartRecording(e);\r\n            };\r\n\r\n            button.addEventListener('touchstart', handleTouchStart, { passive: false });\r\n\r\n            return () => {\r\n                button.removeEventListener('touchstart', handleTouchStart);\r\n            };\r\n        }\r\n    }, [isRecording]);\r\n\r\n    useEffect(() => {\r\n      if (isSettingsOpen) {\r\n        const fetchPromptLibrary = async () => {\r\n          try {\r\n            const response = await getPrompts();\r\n            setPromptLibrary(response.data);\r\n          } catch (err) {\r\n            console.error(\"Failed to fetch prompt library\", err);\r\n          }\r\n        };\r\n        fetchPromptLibrary();\r\n      }\r\n    }, [isSettingsOpen]);\r\n\r\n\r\n    const handleSwapLanguages = () => {\r\n        if (sourceLang === 'auto') return;\r\n        const newSourceLang = targetLang;\r\n        const newTargetLang = sourceLang;\r\n        setSourceLang(newSourceLang);\r\n        setTargetLang(newTargetLang);\r\n    };\r\n\r\n    const handleTranslate = async (e) => {\r\n        if (e) e.preventDefault();\r\n        if (!inputText.trim() || isLoading) return;\r\n\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            const targetLanguageName = targetLanguages.find(lang => lang.code === targetLang)?.name || 'English';\r\n            const response = await addMessageToConversation(id, inputText, targetLanguageName);\r\n            setMessages(prevMessages => [...prevMessages, response.data]);\r\n            setInputText('');\r\n        } catch (apiError) {\r\n            console.error(\"API call failed:\", apiError);\r\n            setError(apiError.response?.data?.detail || \"فشل في إرسال الرسالة.\");\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteMessage = async (messageId) => {\r\n        if (window.confirm('هل أنت متأكد من حذف هذه الرسالة؟')) {\r\n            try {\r\n                await deleteMessage(messageId);\r\n                setMessages(prev => prev.filter(msg => msg.id !== messageId));\r\n            } catch (err) {\r\n                setError('فشل في حذف الرسالة.');\r\n                console.error(err);\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleStartEditing = (message) => {\r\n        setEditingMessage({ id: message.id, text: message.original_text });\r\n    };\r\n\r\n    const handleCancelEditing = () => {\r\n        setEditingMessage({ id: null, text: '' });\r\n    };\r\n\r\n    const handleSaveEdit = async () => {\r\n        if (!editingMessage.text.trim()) return;\r\n        setIsLoading(true);\r\n        try {\r\n            const response = await editMessage(editingMessage.id, editingMessage.text);\r\n            setMessages(prev => prev.map(msg => msg.id === editingMessage.id ? response.data : msg));\r\n            handleCancelEditing();\r\n        } catch (err) {\r\n            setError('فشل في تعديل الرسالة.');\r\n            console.error(err);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePlayAudio = async (text, messageId) => {\r\n        if (playingAudioId === messageId) {\r\n            if (audioRef.current) {\r\n                audioRef.current.pause();\r\n                audioRef.current.currentTime = 0;\r\n            }\r\n            setPlayingAudioId(null);\r\n            return;\r\n        }\r\n\r\n        setPlayingAudioId(messageId);\r\n        try {\r\n            const response = await callTextToSpeechApi(text);\r\n            const audioBlob = response.data;\r\n            const audioUrl = URL.createObjectURL(audioBlob);\r\n            const audio = new Audio(audioUrl);\r\n            audioRef.current = audio;\r\n            audio.play();\r\n            audio.onended = () => { setPlayingAudioId(null); };\r\n            audio.onerror = (e) => {\r\n                console.error(\"Audio playback error:\", e);\r\n                setError('حدث خطأ أثناء تشغيل الصوت.');\r\n                setPlayingAudioId(null);\r\n            }\r\n        } catch (err) {\r\n            setError('فشل في توليد الصوت.');\r\n            setPlayingAudioId(null);\r\n        }\r\n    };\r\n\r\n    const handleSaveSettings = async () => {\r\n        setSaveSettingsStatus('جاري الحفظ...');\r\n        try {\r\n            const settingsToUpdate = {\r\n                use_context: currentUseContext,\r\n                custom_prompt: currentCustomPrompt,\r\n            };\r\n            const response = await updateConversationSettings(id, settingsToUpdate);\r\n            setConversation(response.data);\r\n            setSaveSettingsStatus('تم الحفظ بنجاح!');\r\n            setTimeout(() => {\r\n                setIsSettingsOpen(false);\r\n                setSaveSettingsStatus('');\r\n            }, 1500);\r\n        } catch (err) {\r\n            setSaveSettingsStatus('فشل الحفظ. حاول مرة أخرى.');\r\n            console.error(\"Failed to save settings:\", err);\r\n        }\r\n    };\r\n\r\n    const handleCopyText = (text, messageId) => {\r\n        navigator.clipboard.writeText(text).then(() => {\r\n            setCopiedMessageId(messageId);\r\n            setTimeout(() => setCopiedMessageId(null), 2000);\r\n        }, (err) => {\r\n            console.error('Could not copy text: ', err);\r\n            setError('فشل نسخ النص.');\r\n        });\r\n    };\r\n\r\n    const handleShareText = async (text) => {\r\n        if (navigator.share) {\r\n            try {\r\n                await navigator.share({\r\n                    title: 'ترجمة من المترجم الذكي',\r\n                    text: text,\r\n                });\r\n            } catch (err) {\r\n                console.error('Error sharing:', err);\r\n            }\r\n        } else {\r\n            setError('المشاركة غير مدعومة في هذا المتصفح.');\r\n        }\r\n    };\r\n\r\n    const handleDownloadAudio = async (text) => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            const response = await callTextToSpeechApi(text);\r\n            const audioBlob = response.data;\r\n            const url = window.URL.createObjectURL(audioBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', `translation-${Date.now()}.mp3`);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.parentNode.removeChild(link);\r\n            window.URL.revokeObjectURL(url);\r\n        } catch (err) {\r\n            setError('فشل في تنزيل الملف الصوتي.');\r\n            console.error(err);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleExport = async () => {\r\n        try {\r\n            const response = await exportConversation(id);\r\n            const textBlob = new Blob([response.data], { type: 'text/plain;charset=utf-8' });\r\n            const url = window.URL.createObjectURL(textBlob);\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', `${conversation.title.replace(/\\s/g, '_')}.txt`);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.parentNode.removeChild(link);\r\n            window.URL.revokeObjectURL(url);\r\n        } catch (err) {\r\n            setError('فشل في تصدير المحادثة.');\r\n            console.error(\"Failed to export conversation:\", err);\r\n        }\r\n    };\r\n\r\n    // --- UPDATED: Combined Audio Handling Logic with new state ---\r\n\r\n    const transcribeFile = async (file) => {\r\n        if (!file) return;\r\n        setIsTranscribing(true); // <-- Use new state\r\n        setError('');\r\n        try {\r\n            const response = await transcribeAudio(file);\r\n            setInputText(prev => prev.trim() ? prev + ' ' + response.data.transcribed_text : response.data.transcribed_text);\r\n        } catch (err) {\r\n            const errorDetail = err.response?.data?.detail || 'فشل في تحويل الصوت إلى نص.';\r\n            setError(errorDetail);\r\n            console.error(\"Transcription failed:\", err);\r\n        } finally {\r\n            setIsTranscribing(false); // <-- Use new state\r\n        }\r\n    };\r\n\r\n    const handleStartRecording = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        if (isRecording || isTranscribing) return; // Prevent action if already transcribing\r\n        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n            try {\r\n                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n                setIsRecording(true);\r\n                mediaRecorderRef.current = new MediaRecorder(stream);\r\n                mediaRecorderRef.current.ondataavailable = (event) => {\r\n                    audioChunksRef.current.push(event.data);\r\n                };\r\n                mediaRecorderRef.current.onstop = async () => {\r\n                    const audioBlob = new Blob(audioChunksRef.current, { type: 'audio/webm' });\r\n                    audioChunksRef.current = [];\r\n                    stream.getTracks().forEach(track => track.stop());\r\n                    if(audioBlob.size > 0) {\r\n                        await transcribeFile(audioBlob);\r\n                    }\r\n                };\r\n                mediaRecorderRef.current.start();\r\n            } catch (err) {\r\n                console.error(\"Error accessing microphone:\", err);\r\n                setError(\"لا يمكن الوصول إلى الميكروفون. يرجى التحقق من الأذونات.\");\r\n                setIsRecording(false);\r\n            }\r\n        } else {\r\n            setError(\"المتصفح لا يدعم التسجيل الصوتي.\");\r\n        }\r\n    };\r\n\r\n    const handleStopRecording = (e) => {\r\n        e.preventDefault();\r\n        if (mediaRecorderRef.current && isRecording) {\r\n            mediaRecorderRef.current.stop();\r\n            setIsRecording(false);\r\n        }\r\n    };\r\n\r\n    const handleFileSelect = (event) => {\r\n        const file = event.target.files[0];\r\n        if (file) {\r\n            transcribeFile(file);\r\n        }\r\n        event.target.value = null; \r\n    };\r\n\r\n    const handleUploadClick = () => {\r\n        if (isTranscribing) return;\r\n        fileInputRef.current.click();\r\n    };\r\n    \r\n    if (!conversation) {\r\n        return <div className=\"page-container\">جاري تحميل المحادثة...</div>;\r\n    }\r\n\r\n    // --- NEW: Logic to render the correct button in the input area ---\r\n    const renderInputActions = () => {\r\n        if (isTranscribing) {\r\n            return (\r\n                <button type=\"button\" className=\"mic-button\" disabled>\r\n                    <FaSpinner className=\"fa-spin\" />\r\n                </button>\r\n            );\r\n        }\r\n        if (inputText.trim()) {\r\n            return (\r\n                <button type=\"submit\" className=\"translate-button\" disabled={isLoading}>\r\n                    {isLoading ? <FaSpinner className=\"fa-spin\"/> : <FaPaperPlane />}\r\n                </button>\r\n            );\r\n        }\r\n        return (\r\n            <>\r\n                <button type=\"button\" className=\"mic-button\" onClick={handleUploadClick} title=\"تحميل ملف صوتي\">\r\n                    <FaPaperclip />\r\n                </button>\r\n                <button \r\n                    ref={micButtonRef}\r\n                    type=\"button\" \r\n                    className={`mic-button ${isRecording ? 'recording' : ''}`} \r\n                    onMouseDown={handleStartRecording}\r\n                    onMouseUp={handleStopRecording}\r\n                    onTouchEnd={handleStopRecording}\r\n                    title=\"اضغط باستمرار للتسجيل\"\r\n                >\r\n                    {isRecording ? <FaStop /> : <FaMicrophone />}\r\n                </button>\r\n            </>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"page-container workspace-container\">\r\n                <div className=\"workspace-header\">\r\n                    {/* Header JSX remains the same */}\r\n                    <div className=\"header-top-row\">\r\n                        <h1>{conversation.title}</h1>\r\n                        <div className=\"header-actions\">\r\n                             <button className=\"icon-button\" onClick={handleExport} title=\"تصدير المحادثة\">\r\n                                <FaFileExport />\r\n                            </button>\r\n                            <button className=\"icon-button\" onClick={() => setIsSettingsOpen(true)} title=\"إعدادات المحادثة\">\r\n                                <FaCog />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"header-bottom-row\">\r\n                        <input \r\n                            type=\"text\"\r\n                            placeholder=\"ابحث في الرسائل...\"\r\n                            className=\"message-search-bar\"\r\n                            value={messageSearchQuery}\r\n                            onChange={(e) => setMessageSearchQuery(e.target.value)}\r\n                        />\r\n                        <div className=\"language-controls\">\r\n                            <select className=\"language-select\" value={sourceLang} onChange={(e) => setSourceLang(e.target.value)}>\r\n                                {sourceLanguages.map(lang => (\r\n                                    <option key={lang.code} value={lang.code}>{lang.name}</option>\r\n                                ))}\r\n                            </select>\r\n                            <button className=\"swap-languages-button\" onClick={handleSwapLanguages} title=\"تبديل اللغات\" disabled={sourceLang === 'auto'}>\r\n                                <FaExchangeAlt />\r\n                            </button>\r\n                             <select className=\"language-select\" value={targetLang} onChange={(e) => setTargetLang(e.target.value)}>\r\n                                {targetLanguages.map(lang => (\r\n                                    <option key={lang.code} value={lang.code}>{lang.name}</option>\r\n                                ))}\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div className=\"message-history\">\r\n                    {/* Message mapping code remains the same */}\r\n                    {messages.map((msg) => (\r\n                        <div key={msg.id} className=\"message-pair\">\r\n                            <div className=\"message original-message\">\r\n                                {editingMessage.id === msg.id ? (\r\n                                    <div className=\"edit-container\">\r\n                                        <textarea className=\"edit-textarea\" value={editingMessage.text} onChange={(e) => setEditingMessage({ ...editingMessage, text: e.target.value })} autoFocus />\r\n                                        <div className=\"edit-buttons\">\r\n                                            <button className=\"button-primary\" onClick={handleSaveEdit} disabled={isLoading}>{isLoading ? 'جاري...' : 'حفظ'}</button>\r\n                                            <button onClick={handleCancelEditing}>إلغاء</button>\r\n                                        </div>\r\n                                    </div>\r\n                                ) : (\r\n                                    <>\r\n                                        <span className=\"message-content\">{highlightText(msg.original_text, messageSearchQuery)}</span>\r\n                                        <div className=\"message-actions\">\r\n                                            <button onClick={() => handleStartEditing(msg)} title=\"تعديل\"><FaEdit /></button>\r\n                                            <button onClick={() => handleDeleteMessage(msg.id)} title=\"حذف\"><FaTrash /></button>\r\n                                        </div>\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                            <div className=\"message translated-message\">\r\n                                <span className=\"message-content\">{highlightText(msg.translated_text, messageSearchQuery)}</span>\r\n                                <div className=\"message-actions\">\r\n                                    <button onClick={() => handleCopyText(msg.translated_text, msg.id)} title=\"نسخ النص\">\r\n                                        {copiedMessageId === msg.id ? 'تم النسخ!' : <FaCopy />}\r\n                                    </button>\r\n                                    <button className=\"play-audio-button\" onClick={() => handlePlayAudio(msg.translated_text, msg.id)} title=\"الاستماع للترجمة\">\r\n                                        {playingAudioId === msg.id ? <FaSpinner className=\"fa-spin\" /> : <FaVolumeUp />}\r\n                                    </button>\r\n                                    <button onClick={() => handleDownloadAudio(msg.translated_text)} title=\"تنزيل الصوت\">\r\n                                        <FaDownload />\r\n                                    </button>\r\n                                    {navigator.share && (\r\n                                        <button onClick={() => handleShareText(msg.translated_text)} title=\"مشاركة النص\">\r\n                                            <FaShareAlt />\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                    <div ref={messagesEndRef} />\r\n                </div>\r\n\r\n                {error && <div className=\"status-message error\" onClick={() => setError('')}>{error}</div>}\r\n                \r\n                <form className=\"translation-input-area\" onSubmit={handleTranslate}>\r\n                    <TextareaAutosize \r\n                        className=\"text-area\" \r\n                        value={inputText} \r\n                        onChange={(e) => setInputText(e.target.value)} \r\n                        placeholder={isTranscribing ? \"جاري تفريغ الصوت...\" : \"اكتب النص...\"} // <-- Dynamic placeholder\r\n                        onKeyDown={(e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleTranslate(null); } }} \r\n                        minRows={1}\r\n                        maxRows={6}\r\n                        cacheMeasurements\r\n                        disabled={isTranscribing} // <-- Disable textarea while transcribing\r\n                    />\r\n                    \r\n                    <input\r\n                        type=\"file\"\r\n                        ref={fileInputRef}\r\n                        onChange={handleFileSelect}\r\n                        style={{ display: 'none' }}\r\n                        accept=\"audio/*\"\r\n                    />\r\n                    \r\n                    {/* Use the new render function for buttons */}\r\n                    {renderInputActions()}\r\n\r\n                </form>\r\n            </div>\r\n            {/* Settings Modal code remains the same */}\r\n            {isSettingsOpen && (\r\n                <div className=\"modal-overlay\">\r\n                    <div className=\"modal-content\">\r\n                        <div className=\"modal-header\">\r\n                            <h2>إعدادات المحادثة</h2>\r\n                            <button className=\"modal-close-button\" onClick={() => setIsSettingsOpen(false)}><FaTimes /></button>\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>تفعيل سياق المحادثة</label>\r\n                            <div className=\"toggle-switch\">\r\n                                <input type=\"checkbox\" id=\"context-toggle\" checked={currentUseContext} onChange={(e) => setCurrentUseContext(e.target.checked)} />\r\n                                <label htmlFor=\"context-toggle\" className=\"switch-label\">Toggle</label>\r\n                                <span>{currentUseContext ? \"مفعل\" : \"معطل\"}</span>\r\n                            </div>\r\n                            <p className=\"description\">عند التفعيل، سيتم إرسال الرسائل السابقة مع كل طلب جديد لتحسين دقة الترجمة.</p>\r\n                        </div>\r\n                        \r\n                        <div className=\"form-group\">\r\n                            <label htmlFor=\"custom-prompt-select\">برومبت مخصص</label>\r\n                            <select \r\n                                id=\"custom-prompt-select\"\r\n                                className=\"form-input\"\r\n                                value={currentCustomPrompt}\r\n                                onChange={(e) => setCurrentCustomPrompt(e.target.value)}\r\n                            >\r\n                                <option value=\"\">بدون برومبت</option>\r\n                                {promptLibrary.map(prompt => (\r\n                                    <option key={prompt.id} value={prompt.content}>\r\n                                        {prompt.title}\r\n                                    </option>\r\n                                ))}\r\n                            </select>\r\n                            <p className=\"description\">اختر برومبت جاهز من مكتبتك لتطبيقه على هذه المحادثة.</p>\r\n                        </div>\r\n\r\n                        <button className=\"button-primary\" onClick={handleSaveSettings}>حفظ الإعدادات</button>\r\n                        {saveSettingsStatus && <p className=\"status-message\" style={{ color: 'green' }}>{saveSettingsStatus}</p>}\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default WorkspacePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}